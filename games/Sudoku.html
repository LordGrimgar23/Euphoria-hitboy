<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sudoku</title>
  <style>
    :root{
      --bg:#0b0f17;
      --panel:#111827;
      --grid:#0f172a;
      --line:#334155;
      --line-strong:#94a3b8;
      --text:#e5e7eb;
      --muted:#9ca3af;
      --given:#e5e7eb;
      --user:#93c5fd;
      --bad:#fb7185;
      --ok:#34d399;
      --sel:#1f2937;
      --peer:#111c2d;
      --same:#0b2a4d;
    }
    html,body{height:100%;}
    body{
      margin:0;
      background: radial-gradient(1200px 600px at 50% 0%, #0f1b3d 0%, var(--bg) 60%);
      color:var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .wrap{
      width:min(980px, 96vw);
      display:grid;
      grid-template-columns: 1fr;
      gap:16px;
      padding:20px 0;
    }
    .top{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
      justify-content:space-between;
    }
    .title{
      display:flex;
      flex-direction:column;
      gap:2px;
    }
    .title h1{
      font-size:18px;
      margin:0;
      letter-spacing:0.2px;
    }
    .title .sub{
      font-size:13px;
      color:var(--muted);
    }
    .panel{
      background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
      border:1px solid rgba(148,163,184,0.18);
      border-radius:14px;
      padding:14px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.35);
    }
    .controls{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      align-items:center;
      justify-content:flex-end;
    }
    button{
      appearance:none;
      border:1px solid rgba(148,163,184,0.22);
      background: rgba(17,24,39,0.6);
      color:var(--text);
      padding:10px 12px;
      border-radius:12px;
      cursor:pointer;
      font-weight:600;
      font-size:13px;
      letter-spacing:0.2px;
      transition: transform 0.06s ease, background 0.15s ease, border-color 0.15s ease;
      user-select:none;
    }
    button:hover{ background: rgba(17,24,39,0.85); border-color: rgba(148,163,184,0.32); }
    button:active{ transform: translateY(1px); }
    .status{
      margin-top:10px;
      font-size:13px;
      color:var(--muted);
      display:flex;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
    }
    .board{
      display:grid;
      grid-template-columns: 1fr;
      gap:14px;
    }
    .grid{
      width:min(540px, 92vw);
      aspect-ratio:1/1;
      margin:auto;
      display:grid;
      grid-template-columns: repeat(9, 1fr);
      background: rgba(15, 23, 42, 0.6);
      border:2px solid rgba(148,163,184,0.35);
      border-radius:14px;
      overflow:hidden;
    }
    .cell{
      display:flex;
      align-items:center;
      justify-content:center;
      font-size: clamp(18px, 3.7vw, 26px);
      border:1px solid rgba(51,65,85,0.55);
      background: rgba(15,23,42,0.35);
      color:var(--user);
      cursor:pointer;
      user-select:none;
      position:relative;
      outline:none;
    }
    .cell.given{
      color:var(--given);
      font-weight:800;
      background: rgba(15,23,42,0.55);
      cursor:default;
    }
    .cell[data-c="2"], .cell[data-c="5"]{ border-right:2px solid rgba(148,163,184,0.55); }
    .cell[data-c="3"], .cell[data-c="6"]{ border-left:2px solid rgba(148,163,184,0.55); }
    .cell[data-r="2"], .cell[data-r="5"]{ border-bottom:2px solid rgba(148,163,184,0.55); }
    .cell[data-r="3"], .cell[data-r="6"]{ border-top:2px solid rgba(148,163,184,0.55); }
    .cell.selected{ background: rgba(31,41,55,0.75); }
    .cell.peer{ background: rgba(17,28,45,0.65); }
    .cell.same{ background: rgba(11,42,77,0.65); }
    .cell.bad{
      color: var(--bad);
      text-shadow: 0 0 14px rgba(251,113,133,0.25);
    }
    .hintRow{
      display:flex;
      gap:10px;
      justify-content:center;
      flex-wrap:wrap;
      color:var(--muted);
      font-size:13px;
      text-align:center;
    }
    .kbd{
      padding:2px 6px;
      border:1px solid rgba(148,163,184,0.25);
      border-bottom-color: rgba(148,163,184,0.35);
      border-radius:6px;
      background: rgba(17,24,39,0.5);
      color: var(--text);
      font-weight:700;
      font-size:12px;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="top panel">
      <div class="title">
        <h1>Sudoku</h1>
        <div class="sub">Click a cell. Use <span class="kbd">1–9</span> to enter, <span class="kbd">⌫</span>/<span class="kbd">Del</span> to clear, arrows to move.</div>
      </div>
      <div class="controls">
        <button id="newBtn">New Puzzle</button>
        <button id="resetBtn">Reset</button>
        <button id="solveBtn">Solve</button>
      </div>
    </div>
    <div class="board panel">
      <div id="grid" class="grid" aria-label="Sudoku grid" role="grid"></div>
      <div class="hintRow">
        Highlights: selected cell, its row/col/box, and matching numbers.
      </div>
      <div class="status">
        <div id="msg">Ready.</div>
        <div id="meta"></div>
      </div>
    </div>
  </div>
<script>
(() => {
  const PUZZLES = [
    [
      0,0,0, 2,6,0, 7,0,1,
      6,8,0, 0,7,0, 0,9,0,
      1,9,0, 0,0,4, 5,0,0,
      8,2,0, 1,0,0, 0,4,0,
      0,0,4, 6,0,2, 9,0,0,
      0,5,0, 0,0,3, 0,2,8,
      0,0,9, 3,0,0, 0,7,4,
      0,4,0, 0,5,0, 0,3,6,
      7,0,3, 0,1,8, 0,0,0
    ],
    [
      0,2,0, 6,0,8, 0,0,0,
      5,8,0, 0,0,9, 7,0,0,
      0,0,0, 0,4,0, 0,0,0,
      3,7,0, 0,0,0, 5,0,0,
      6,0,0, 0,0,0, 0,0,4,
      0,0,8, 0,0,0, 0,1,3,
      0,0,0, 0,2,0, 0,0,0,
      0,0,9, 8,0,0, 0,3,6,
      0,0,0, 3,0,6, 0,9,0
    ],
    [
      0,0,0, 0,0,0, 0,1,2,
      0,0,0, 0,0,7, 0,0,0,
      0,0,1, 0,9,0, 0,0,0,
      0,0,0, 0,0,0, 3,0,0,
      0,0,0, 5,0,9, 0,0,0,
      0,0,8, 0,0,0, 0,0,0,
      0,0,0, 0,4,0, 2,0,0,
      0,0,0, 7,0,0, 0,0,0,
      6,9,0, 0,0,0, 0,0,0
    ]
  ];
  const gridEl = document.getElementById('grid');
  const msgEl = document.getElementById('msg');
  const metaEl = document.getElementById('meta');
  const newBtn = document.getElementById('newBtn');
  const resetBtn = document.getElementById('resetBtn');
  const solveBtn = document.getElementById('solveBtn');
  let given = [];
  let board = [];
  let solution = null;
  let selected = { r: 0, c: 0 };
  function rcToI(r,c){ return r*9+c; }
  function boxIndex(r,c){ return Math.floor(r/3)*3 + Math.floor(c/3); }
  function setMessage(text, kind="muted"){
    msgEl.textContent = text;
    msgEl.style.color = (kind==="ok") ? "var(--ok)" : (kind==="bad") ? "var(--bad)" : "var(--muted)";
  }
  function clone(arr){ return arr.slice(); }
  function buildGrid(){
    gridEl.innerHTML = "";
    for(let r=0;r<9;r++){
      for(let c=0;c<9;c++){
        const cell = document.createElement('div');
        cell.className = "cell";
        cell.setAttribute('role', 'gridcell');
        cell.tabIndex = -1;
        cell.dataset.r = r;
        cell.dataset.c = c;
        cell.addEventListener('click', () => selectCell(r,c));
        gridEl.appendChild(cell);
      }
    }
  }
  function render(){
    const cells = gridEl.children;
    let isFull = true;
    let hasError = false;
    for(let r=0;r<9;r++){
      for(let c=0;c<9;c++){
        const i = rcToI(r,c);
        const cell = cells[i];
        const v = board[i];
        const g = given[i] !== 0;
        cell.textContent = v === 0 ? "" : String(v);
        cell.classList.toggle("given", g);
        cell.classList.remove("selected","peer","same","bad");
        if(v===0) isFull = false;
        if(v !== 0 && solution && v !== solution[i]){
            cell.classList.add("bad");
            hasError = true;
        }
      }
    }
    applyHighlights();
    metaEl.textContent = `Filled: ${board.filter(x=>x!==0).length}/81`;
    if(isFull && !hasError) setMessage("Solved! ✅", "ok");
  }
  function applyHighlights(){
    const cells = gridEl.children;
    const selI = rcToI(selected.r, selected.c);
    const selVal = board[selI];
    for(let r=0;r<9;r++){
      for(let c=0;c<9;c++){
        const i = rcToI(r,c);
        const cell = cells[i];
        const isSel = (r===selected.r && c===selected.c);
        const isPeer = (r===selected.r) || (c===selected.c) || (boxIndex(r,c)===boxIndex(selected.r,selected.c));
        const isSame = (selVal!==0 && board[i]===selVal);
        if(isSel) cell.classList.add("selected");
        else if(isPeer) cell.classList.add("peer");
        if(isSame && !isSel) cell.classList.add("same");
      }
    }
  }
  function selectCell(r,c){
    selected = { r, c };
    applyHighlights();
    const i = rcToI(r,c);
    gridEl.children[i].focus();
  }
  function loadPuzzle(puz){
    given = clone(puz);
    board = clone(puz);
    solution = null;
    const candidate = clone(puz);
    if (solveInPlace(candidate)) solution = candidate;
    else solution = null;
    render();
    setMessage("New puzzle loaded.");
    selectCell(0,0);
  }
  function randomPuzzle(){
    const idx = Math.floor(Math.random() * PUZZLES.length);
    return { puzzle: PUZZLES[idx], index: idx };
  }
  function reset(){
    board = clone(given);
    render();
    setMessage("Reset to original puzzle.");
  }
  function inRange(v){ return v>=1 && v<=9; }
  function isValidMove(arr, r, c, v){
    for(let k=0;k<9;k++){
      if(k!==c && arr[rcToI(r,k)]===v) return false;
      if(k!==r && arr[rcToI(k,c)]===v) return false;
    }
    const br = Math.floor(r/3)*3, bc = Math.floor(c/3)*3;
    for(let rr=br; rr<br+3; rr++){
      for(let cc=bc; cc<bc+3; cc++){
        if(rr===r && cc===c) continue;
        if(arr[rcToI(rr,cc)]===v) return false;
      }
    }
    return true;
  }
  function findEmpty(arr){
    for(let i=0;i<81;i++) if(arr[i]===0) return i;
    return -1;
  }
  function candidates(arr, r, c){
    const possible = [];
    for(let v=1; v<=9; v++){
      if(isValidMove(arr, r, c, v)) possible.push(v);
    }
    return possible;
  }
  function solveInPlace(arr){
    let bestI = -1;
    let bestCands = null;
    for(let i=0;i<81;i++){
      if(arr[i]!==0) continue;
      const r = Math.floor(i/9), c = i%9;
      const cands = candidates(arr, r, c);
      if(cands.length===0) return false;
      if(bestI===-1 || cands.length < bestCands.length){
        bestI = i;
        bestCands = cands;
        if(cands.length===1) break;
      }
    }
    if(bestI===-1) return true; 
    const r = Math.floor(bestI/9), c = bestI%9;
    for(let j=bestCands.length-1; j>0; j--){
      const k = Math.floor(Math.random()*(j+1));
      [bestCands[j], bestCands[k]] = [bestCands[k], bestCands[j]];
    }
    for(const v of bestCands){
      arr[bestI] = v;
      if(solveInPlace(arr)) return true;
      arr[bestI] = 0;
    }
    return false;
  }
  function solve(){
    if(!solution){
      const cand = clone(given);
      if(solveInPlace(cand)) solution = cand;
      else {
        setMessage("This puzzle seems unsolvable.", "bad");
        return;
      }
    }
    board = clone(solution);
    render();
    setMessage("Solved.", "ok");
  }
  function trySetValue(v){
    const i = rcToI(selected.r, selected.c);
    if(given[i] !== 0) return;
    if(v===0){
      board[i] = 0;
      render();
      setMessage("Cleared.");
      return;
    }
    if(!inRange(v)) return;
    board[i] = v;
    render(); 
    
    if (solution && board[i] !== solution[i]) {
        setMessage("Incorrect!", "bad");
    } else {
        setMessage("");
    }
  }
  function moveSel(dr, dc){
    let r = selected.r + dr;
    let c = selected.c + dc;
    if(r<0) r=0;
    if(r>8) r=8;
    if(c<0) c=0;
    if(c>8) c=8;
    selectCell(r,c);
  }
  document.addEventListener('keydown', (e) => {
    const key = e.key;
    const tag = (document.activeElement && document.activeElement.tagName) || "";
    const isButton = tag.toLowerCase() === "button";
    if(isButton && (key === "Enter" || key === " ")) return;
    if(key >= '1' && key <= '9'){
      e.preventDefault();
      trySetValue(parseInt(key,10));
      return;
    }
    if(key === 'Backspace' || key === 'Delete' || key === '0'){
      e.preventDefault();
      trySetValue(0);
      return;
    }
    if(key === 'ArrowUp'){ e.preventDefault(); moveSel(-1,0); return; }
    if(key === 'ArrowDown'){ e.preventDefault(); moveSel(1,0); return; }
    if(key === 'ArrowLeft'){ e.preventDefault(); moveSel(0,-1); return; }
    if(key === 'ArrowRight'){ e.preventDefault(); moveSel(0,1); return; }
    if(key.toLowerCase() === 'n'){ e.preventDefault(); newPuzzle(); return; }
    if(key.toLowerCase() === 'r'){ e.preventDefault(); reset(); return; }
    if(key.toLowerCase() === 's'){ e.preventDefault(); solve(); return; }
  });
  function newPuzzle(){
    const { puzzle, index } = randomPuzzle();
    loadPuzzle(puzzle);
    metaEl.textContent = `Puzzle #${index+1} • Filled: ${board.filter(x=>x!==0).length}/81`;
  }
  newBtn.addEventListener('click', newPuzzle);
  resetBtn.addEventListener('click', reset);
  solveBtn.addEventListener('click', solve);
  buildGrid();
  newPuzzle();
})();
</script>
</body>
</html>
